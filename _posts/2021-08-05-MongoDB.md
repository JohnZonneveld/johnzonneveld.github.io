---
layout: post
title: "MongoDB and Express"
---

**What is MongoDB, NoSQL vs SQL**

MongoDB is an open-source document database, those documents can contains all the information related to the object. So during a search and the need to display information related to an object all the info can be obtained from the document in stead of gathering information between database tables.
MongoDB is also referred as a NoSQL database. In the early 2000s when the prices for storage dropped there was no longer a need to try to reduce duplicated data which was done with the relational database.  

So for example when using a blog post in a SQL database we would have a separate table for the blog post and a separate table for the comments with the blog post id used as a foreign key in the comments table. In a NoSQL database we would simply embed the comments inside the document that contains the blog post. In that way in a NoSQL database the blog post and the comments are kept together.  

SQL Databases have a 'strong' schema, which means a predetermined schema that all records (or rows) will adhere too. And have a relational nature, data stored over multiple tables connected by relations (one-to-one, one-to-many, many-to-many).  
NoSQL databases like MongoDB is not tied by a schema, every document(record in SQL) in a collection(table in SQL) can have different a data format. You can setup relations between collections but a NoSQL databases rely less on those relations. In stead they store all information in one place.  

For example in a webstore solution, you still may have a order collection, customer collection and a product collection. The order collection however will contain all necesary information of both other collections to be able to process the order. In other words, during an order lookup you can simply look in the order collection for the order document to find out what product the customer ordered but also get access to the shipping address. In a big order, product and customer base this will be faster than doing a order lookup in the order table, obtain both the customer.id and the product.id, then go to those tables and do a lookup to access the information needed.  

**Install mongodb locally**

For my mern project to avoid problems with remote connections I decided to use a local mongodb installation.  
The installation itself is pretty simple, all that is needed when brew is installed is:  
{% highlight javascript %}
brew install mongodb-community@5.0
{% endhighlight %}  
to install the latest version.  

**Run mongodb as a service**

After installation you have two choices to run the mongodb. You can either run it manually from the command line, or run it as a service.  
To run mongodb on a Mac as a service you have to run the command:  
{% highlight javascript %}
brew services start mongodb-community@5.0
{% endhighlight %}

The '5.0' can differ depending on your installation.

After this mongodb will run in the background.
The normal services commands are valid.
- stop the service  
{% highlight javascript %}
    brew services stop mongodb-community@5.0
{% endhighlight %}

- restart the service  
{% highlight javascript %}
    brew services restart mongodb-community@5.0 
{% endhighlight %} 

**Installing needed dependencies**

For our MERN (MongoDB, Express, React and Node.js) project we will need to install some dependencies. The MongoDB part is already taken care of with the local install. But we still need to install the rest.

Express is minimalist web framework for Node.js, which is very flexible and offers a robust set of features for web and mobile applications.  
We install it with the command:  
{% highlight javascript %}
npm install express --save
{% endhighlight %}  
The --save will add the dependency for this to our package.json, in case someone wants to use our repo it will be included when they run 'npm install'  

Dotenv is used to store our global variables. We install it with:
{% highlight javascript %}
npm install dotenv --save
{% endhighlight %}

Mongoose is a ODM (Object Data Mapper) it creates a layer that we can use to interact with our database, we can create model and we can make queries to our database.
Installation with:
{% highlight javascript %}
npm install mongoose --save
{% endhighlight %}

Handy but not really necessary are nodemon and concurrently for development purposes.
Nodemon allows to run our server without the need of constantly restarting it when file changes are made. Concurrently allows us to start the frontend and the backend with just one npm script.  
We install them with 
{% highlight javascript %}
npm install -D nodemon concurrently
{% endhighlight %}

**Changes to package.json**

In the package.json we change the default script.
The default script we replace with:
{% highlight javascript %}
"scripts": {
    "start": "node server",
    "server": "nodemon server"
  },
  {% endhighlight %}

  The {% highlight javascript %}"start": "node server"{% endhighlight %} will run in production, it will start our Node.js session and points to the server.js file (change if needed) that is our entry point of the application.
  The {% highlight javascript %}"server": "nodemon server"{% endhighlight %} we use to watch the server.
  Now we can start our complete environment with nodemon with the command. {% highlight javascript %}npm start server{% endhighlight %}, start will start the Node.js part and server will start nodemon.